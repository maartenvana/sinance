@page "/Transactions/Search"
@inject Sinance.BlazorApp.Business.Services.ITransactionService transactionService
@using Sinance.BlazorApp.Business.Model.Transaction
@using System.Globalization

<h3>Search</h3>

<button class="btn btn-primary" @onclick="SearchOrders">Search</button>

<table class="table table-striped table-hover mb-0" id="OrderTable">
    <thead>
        <tr>
            <th>Order</th>
            <th>Reference</th>
            <th>Status</th>
            <th>Flow</th>
            <th>Created On</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var transaction in Transactions)
        {
        <tr>
            <td>@transaction.Date</td>
            <td>@transaction.Name</td>
            <td>@transaction.CategoryName</td>
            <td>@transaction.Amount.ToString("0.##", CultureInfo.CurrentCulture)</td>
            <td>@transaction.Description</td>
        </tr>
        }
    </tbody>
</table>


@code {
    public SearchTransactionsFilterModel FilterModel;

    public List<TransactionModel> Transactions { get; set; }

    protected override void OnInitialized()
    {
        FilterModel = new SearchTransactionsFilterModel
        {
            Page = 0,
            PageSize = 500
        };
        Transactions = new List<TransactionModel>();

        base.OnInitialized();
    }

    public async Task SearchOrders()
    {
        Transactions = await transactionService.SearchTransactionsPaged(FilterModel);

        base.StateHasChanged();
    }
}
