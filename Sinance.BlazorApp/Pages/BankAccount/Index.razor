@page "/BankAccount/{Id:int}"
@using Sinance.BlazorApp.Business.Model.BankAccount
@using Sinance.BlazorApp.Business.Model.Transaction
@using Sinance.BlazorApp.Business.Services
@inject IBankAccountService bankAccountService

<BodyContent Title="@($"{bankAccount.Name}: {bankAccount.CurrentBalance.ToString("C2")}")">
    <TransactionsPanel FilterModel=FilterModel @ref=transactionsPanel />
</BodyContent>

@code {
    [Parameter]
    public int Id { get; set; }

    public FindAccountTransactionsFilter FilterModel;

    private TransactionsPanel transactionsPanel;

    private BankAccountModel bankAccount;

    protected override void OnParametersSet()
    {
        bankAccount = bankAccountService.GetBankAccount(Id);

        FilterModel = new FindAccountTransactionsFilter
        {
            BankAccountId = Id,
            PageSize = 25
        };
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await transactionsPanel.RefreshAsync();
    }
}
