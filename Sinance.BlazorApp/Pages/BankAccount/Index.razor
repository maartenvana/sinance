@page "/BankAccount/{Id:int}"
@using Sinance.BlazorApp.Business.Model.BankAccount
@using Sinance.BlazorApp.Business.Model.Transaction
@using Sinance.BlazorApp.Business.Services
@using Sinance.BlazorApp.Components.Transactions.Panel
@inject IBankAccountService bankAccountService

<BodyContent Title="@bankAccount.Name">
    <TransactionsPanel FilterModel=FilterModel @ref=transactionsPanel />
</BodyContent>

@code {
    [Parameter]
    public int Id { get; set; }

    public SearchTransactionsFilterModel FilterModel;

    private TransactionsPanel transactionsPanel;

    private BankAccountModel bankAccount;

    protected override void OnInitialized()
    {
        bankAccount = bankAccountService.GetBankAccount(Id);

        base.OnInitialized();
    }

    protected override void OnParametersSet()
    {
        FilterModel = new SearchTransactionsFilterModel
        {
            BankAccountId = Id
        };
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await transactionsPanel.RefreshAsync();
    }
}
