@using System
@using System.Linq
@using Sinance.Communication.Model.Transaction

@model TransactionModel

<tr id="TransactionRow@(Model.Id)">
    <td class="dateColumn">
        @Model.Date.ToString("dd-MM-yyyy")
    </td>
    <td class="nameColumn">
        @Model.Name
    </td>
    <td class="categoryColumn">
        <a id="transactionCategory@(Model.Id)" tabindex="0" class="transactionCategoryBox" onclick="SetSelectedTransaction(@Model.Id, [@string.Join(",", Model.Categories.Select(item => item.CategoryId))])">
            @foreach (var transactionCategory in Model.Categories)
            {
                int width = 50;

                if (Model.Categories.Count() > 1)
                {
                    width = (int)Math.Round(((transactionCategory.Amount ?? 1) / Model.Amount * 50));
                    if (width < 0)
                    {
                        // Invert if this was a negative width
                        width *= -1;
                    }
                }

                string style = string.Format("width:{0}px;background-color:{1};", width, transactionCategory.ColorCode);
                <div class="transactionCategoryFillBox" style="@style"></div>
            }
        </a>
    </td>
    <td class="amountColumn">
        <span class="label @(Model.Amount > 0 ? "label-success" : "label label-danger")">
            @Html.DisplayFor(item => item.Amount)
        </span>
    </td>
    <td class="descriptionColumn">
        @Model.Description
    </td>
    <td>
        <button class="btn btn-info" type="button" data-toggle="modal" data-target="#overviewModal" onclick="SetSelectedTransaction(@Model.Id); action = 'details';">
            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
        </button>
    </td>
</tr>